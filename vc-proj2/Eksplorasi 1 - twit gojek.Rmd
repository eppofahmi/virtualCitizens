---
title: "Twit tentang Gojek"
output:
  html_notebook: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

## Pendahuluan
Data yang digunakan di sini diambil dengan menggunakan beberapa parameter, yaitu: 

1. tagar #savegojek
2. tagar #savedrivergojek
3. tagar #saveojekonline
4. ceritan transportasi online timeline

Tujuan ekplorasi adalah: 

1. Memisahkan data yang dapat dianalisis dan yang tidak (duplicate dan atau kontennya tidak relevan)
2. Mengetahui utama (jika ada)
3. Mengetahui isi yang dibahas

## Library

```{r}
library(lubridate)
library(tidyverse)
library(tidytext)
library(stringr)
library(tm)
library(reshape2)
library(scales)
library(AnomalyDetection)
```

## Import Data

```{r}
dirwd <- paste(getwd(),"/wrangled data proj-2/",sep='')
twit_gojek <- read.csv(paste(dirwd,"twit-gojek.csv",sep=''), 
                     header = TRUE, sep = ",", stringsAsFactors = FALSE)
```

## Eksplorasi 1 - Perbandingan Sumber data
Data yang digunakan di sini bersumber dari beberapa parameter yang digunakan untuk scrapping. Gambar di bawah ini, menunjukkan perbandingan jumlah twit yang dihasilkan oleh masing-masing parameter. 

```{r}
twit_gojek %>%
  group_by(parameter) %>%
  count(parameter) %>%
  ggplot(aes(parameter, n)) + geom_col() +
  labs( x = "Parameter Pencarian", y = "Jumlah Twit")
```

  >Sebagian besar (mayoritas data) berasal dari twit yang didapat dengan menggunakan parameter #savegojek

Namun, data di atas masih kotor (ada yang duplicate dan tidak relevan). Salah satunya adalah twit yang diposting oleh akun @poocongs, di mana akun tersebut menggunakan tagar #savegojek dalam twitnya, namun isinya tidak membahas tentang gojek. Untuk itu, dalam gambar data akan dibersihkan terlebih dahulu dari: 

1. twit duplicate
2. twit dari akun @poocongs

```{r}
twit_gojek %>%
  filter(is_duplicate == FALSE) %>%
  filter(!user == "poocongs") %>%
  group_by(parameter) %>%
  count(parameter) %>%
  ggplot(aes(parameter, n)) + geom_col() +
  labs( x = "Parameter Pencarian", y = "Jumlah Twit")
```

Gambar di atas menunjukkan bahwa distribusi twit masih didominasi oleh tagar #savegojek. Namun dilihat dari segi jumlahnya, twit dengan tagar tersebut sudah menunurun dibanding sebelumnya.

## Eksplorasi 2 - Username pengirim twit

```{r}
twit_gojek %>%
  filter(is_duplicate == FALSE) %>%
  filter(!user == "poocongs") %>%
  group_by(user) %>%
  count(user, sort = TRUE) %>%
  head(n = 20) %>%
  ggplot(aes(x = reorder(user, n), y = n)) + geom_col() + coord_flip() +
  labs( x = "Username", y = "Jumlah Twit")
```

Setelah dibersihkan total masih tersisi **4995** twit dengan daftar username yang paling banyak mengirim twit di atas. Selanjutnya, ekploasi dilakukan terhadap asal twit berdasarkan waktu

## Eksplorasi 3 - Distribusi twit

```{r}
twit_gojek$date <- as.Date(twit_gojek$date)

twit_gojek %>%
  filter(is_duplicate == FALSE) %>%
  filter(!user == "poocongs") %>%
  group_by(parameter) %>%
  count(date, sort = TRUE) %>% 
  ggplot(aes(x=date, y=n, colour=parameter)) +
  geom_line(show.legend = FALSE) +
  scale_x_date(labels = date_format("%Y-%m"), 
               breaks = date_breaks("3 months")) +
  facet_grid(parameter~., scales="free") +
  theme(legend.position="top")
```

Gambar di atas menunjukkan asal waktu untuk masing-masing paramter pencarian twit. Twit dengan tagar #savedrivergojek berasal dari akhir tahun 2016 hingga akhir 2017, dengan puncaknya sekitar bulan 11 tahun 2017. Di sini parameter yang lain juga dapat dilihat tren penggunaan dan postingan twitnya. 

## Eksplorasi 4 - Tagar

```{r}
twit_gojek %>%
  filter(is_duplicate == FALSE) %>%
  filter(!user == "poocongs") %>%
  select(hashtag) %>%
  unnest_tokens(tagar, hashtag) %>%
  count(tagar, sort = TRUE) %>%
  filter(!tagar == "savegojek") %>%
  filter(!tagar == "savedrivergojek") %>%
  filter(!tagar == "saveojekonline") %>%
  filter(!tagar == "gojek") %>%
  filter(!tagar == "akukaukita") %>%
  head(n = 20) %>%
  ggplot(aes(reorder(tagar, n), n)) + geom_col() + coord_flip() +
  labs(x = "tagar", y = "jumlah tagar")
```

Gambar di atas menunjukkan tagar yang paling sering digunakan setelah dilakukan filter terlebih dahulu. Tagar yang tidak diikutsertakan di antaranya adalah, tagar yang menjadi parameter pencarian, tagar gojek, dan akukaukita.

## Eksplorasi 5 - Term
Term yang digunakan dalam twit setelah di cleaning dapat dilihat pada gambar di bawah ini. Gambar menunjukkan 20 pasangan kata (bigram) yang paling sering muncul dalam data. 

```{r}
twit_gojek %>%
  filter(is_duplicate == FALSE) %>%
  filter(!user == "poocongs") %>%
  select(clean_text) %>%
  unnest_tokens(kata, clean_text, token = "ngrams", n = 2) %>%
  count(kata, sort = TRUE) %>%
  head(n = 20) %>%
  ggplot(aes(reorder(kata, n), n)) + geom_col() + coord_flip() +
  labs(x = "bigram", y = "jumlah bigram")
```

Bigram yang paling sering muncul, yaitu "ojek online" menunjukkan bahwa dokumen teks sebagian besar membahas tentang ojek online atau transportasi online. Hal tersebut ditunjukkan dengan tingginya coocurrance kata ojek dengan online. 

## Eksplorasi 6 - TF-IDF

```{r}
a <- twit_gojek %>%
  filter(is_duplicate == FALSE) %>%
  filter(!user == "poocongs") %>%
  select(parameter, clean_text) %>%
  group_by(parameter) %>%
  unnest_tokens(kata, clean_text, token = "ngrams", n = 2) %>%
  count(kata, sort = TRUE)

total_words <- a %>% 
  group_by(parameter) %>% 
  summarize(total = sum(n))

twit_words <- left_join(a, total_words)

twit_words <- twit_words %>%
  bind_tf_idf(kata, parameter, n) %>%
  arrange(desc(tf_idf))


# Visualisasi tf-idf
twit_words %>%
  arrange(desc(tf_idf)) %>%
  mutate(kata = factor(kata, levels = rev(unique(kata)))) %>% 
  group_by(parameter) %>% 
  top_n(5) %>% 
  ungroup %>%
  ggplot(aes(reorder(kata,tf_idf), tf_idf, fill = parameter)) +
  geom_col(show.legend = FALSE) +
  labs(x = NULL, y = "tf-idf") +
  facet_wrap(~parameter, ncol = 2, scales = "free") +
  coord_flip()
```

## Eksplorasi 7 - Network


## Eksplorasi 8 - Topic Modelling

